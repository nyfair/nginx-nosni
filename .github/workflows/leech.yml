name: leech

on:
  push:
    paths:
    - '.github/workflows/leech.yml'

jobs:
  build:
    strategy:
      fail-fast: false
      matrix:
        url:
        - https://mega.nz/file/xrtFCJia#N_VnU6Glm_SLY5O8Wfx34zCNi2AnfO9uE2JFBLkJBqA
        - https://mega.nz/file/5uNEQCaL#QoxB3d_YRz_gMAtSy1ifeDdtAyIALaWHFAF5u6HDSqg
        - https://mega.nz/file/RqclEZqI#ccxGI20-UPO-_BfzakGBpM5S3tLsKtlL99tO1e2kE6g
        - https://mega.nz/file/dm1xnAJL#TKGMSXFDYmH4I8bgiUD4gHt9JuT98TMFgN5ureOCSl4
        - https://mega.nz/file/syVxhRbB#U52uxaJTKK8snGz8OGSIX3te43nX1kPtycYo2WpRCWI
        - https://mega.nz/file/hysSxDTb#PtzDEFWkhSPFVIjNs7BcIBcIsXQU2xsI5oC7EvO3a0Y
        - https://mega.nz/file/tzclSZZK#jOTbd1-58D8a3BHXmdwmx0ub9-CtfEWUh6rzrcWmO0M
        - https://mega.nz/file/QC82kZjJ#G_H7_SRdvg_f0gIuPEQFFLY74oNue_O6pSNCYKKJqCc
        - https://mega.nz/file/FLd2zCxL#N5C6bcjit_yHp3XyqCUqiubh2ISUHkooSGqGNPMEC4w
        - https://mega.nz/file/cb1EBKrI#YwH0MLr6g44FzV92OAZecvyGHx5Dw903JfitDvm3Fx0
        - https://mega.nz/file/9OkC2ITT#duRFOPSAb8s_Vd4a4xQTVwdL7Ob0SRuiW0U6ckVcLTo
        - https://mega.nz/file/MPNDzI6D#W2h0ODqNccO7jFTHkvqVATToE8dlApJryZ8u77Fd6XM
        - https://mega.nz/file/pT0zHQBC#VbBkmJ4AjvZwZ7o7_n5yLoUZznJaQEfB3e82u4lnFt8
        - https://mega.nz/file/AecQxLLZ#-PXvwLrV2c8Kg8oZEG-DMvd5H4rzsLu6Pi12sNStaGM
        - https://mega.nz/file/tXViABLJ#OfKJDevOdTCnqQ31PyAtg8l3J2oDORmcCbqucDg6Eho
        - https://mega.nz/file/kTtRxaQY#Of0rzn4WHrUi6CAmAg__sM2Z1EO9vtve-D5uIqYu6-A
        - https://mega.nz/file/BT1THBRC#BJy1UDSq_gqepuKT0WzPWnh6GpDqOyRkVFdQw305GjQ
        - https://mega.nz/file/oKNHnIyK#x0hKvcrA6T4GxscP7nzlfU868W3_2Kvqw3zUIDj7460
        - https://mega.nz/file/IOlzQSSA#8XoeY7OCgeTgjLAoZtFsVsq2UrzA42wUAaCHFYbuM1M
        - https://mega.nz/file/4bdTDY6R#M3gFJ5-frkev94l4g38uqRboWzHie9X9dj5gL_apLkU
        - https://mega.nz/file/EfMSibpL#JcQCu2LnqGIkVBhHaouQu7pXvX4SPntmwKZev_qyzEE
        - https://mega.nz/file/UPUkiQRS#1mC3ln1lWkKJWBhWlgw_wKiVQwRblv0LkuBgiZPnDpY
        - https://mega.nz/file/ALt3jLoB#BogTiCLzZH4BwHOdzmVlMbai-WCrqpxpHNNQNmro0qs
        - https://mega.nz/file/weFzGAiC#-JRreylX3DoyyIVT08zW0jZzG_PfXaFB_H6Kaja3xwA
        - https://mega.nz/file/EaFV1QDQ#erhMmUdBor8GaEWk_rLjIo7W5LasZjkyja9vJAZ0QoM
        - https://mega.nz/file/MScX1CIT#M_wjgKGh_a_VyLUWARKEt-YQXGgHpGKkMPNNulFtoEU
    runs-on: ubuntu-latest
    steps:
    - uses: actions/cache@v4
      id: cache
      with:
        path: megatools-1.11.1.20230212-linux-x86_64
        key: megatools-1.11.1.20230212-linux-x86_64
    - name: Mega
      if: steps.cache.outputs.cache-hit != 'true'
      run: |
        curl -OL https://megatools.megous.com/builds/builds/megatools-1.11.1.20230212-linux-x86_64.tar.gz
        tar xvf *.gz
    - name: Leech
      run: |
        mkdir leech
        megatools*/megatools dl --path leech/ ${{ matrix.url }}
        cd leech
        find . -size +1960M -exec split -b 1G --numeric-suffixes=1 {} {}.0 \;
        find . -size +1960M -exec rm {} \;
    - name: Upload
      uses: svenstaro/upload-release-action@v2
      with:
        repo_token: ${{ secrets.GITHUB_TOKEN }}
        file: leech/*
        tag: latest
        overwrite: true
        file_glob: true
