name: leech

on:
  push:
    paths:
    - '.github/workflows/leech.yml'

jobs:
  build:
    strategy:
      fail-fast: false
      matrix:
        url:
        - https://mega.nz/file/YPMggQAA#q2DoVb7yOljPmtpZezSkmorlKyBtxzjn3O8GGZy4DmU
        - https://mega.nz/file/FPkyyb7Y#PmhRe-COU7EHEEk3a9VqibmnYIm67hWKLD3WsLeiS4k
        - https://mega.nz/file/0WsAiZ7A#LJD-m273NgZm_PNDumZUy8O0k3r4FnV7okNcmj0PCj0
        - https://mega.nz/file/9bsUDCRZ#63SsiUD832z4FGx-0mSzEyDOzNGEmB7uZCvZI30N7o0
        - https://mega.nz/file/FD8hyB6B#dRKqR_7pGDHiNtyE0jCovCjBiuNDzp9yd8saLuyYdo0
        - https://mega.nz/file/NPsgwRJZ#E_RmEiy1VNR9N-JY_lGf3LgFXh3GeseUv0Ufuq2MSt0
        - https://mega.nz/file/FH0TBRJL#GBQMxCx7PwOfzw2x8Vtw4QRqd8ZRwhEOE4mR2RDsuvQ
        - https://mega.nz/file/ML1WiaYQ#lAXtu-fT1ur-3BBbSAb77frApgddrw5OxpkEbPSMjvE
        - https://mega.nz/file/pXFw0a5R#dNuYj9LGdqMjDfPjtqpzZgG_qPQeM09YGjGjER14Z3E
        - https://mega.nz/file/VGNQUZYI#3ZX-MH6bZyYdWjNUveX-BwJp0JXnacFNyTrDKTLYQ0c
        - https://mega.nz/file/ce8h2RAZ#upGXCS92clCu2cP9uLnQ67m5jkcQNiXLd_P-c52p2eU
        - https://mega.nz/file/QK1RFSDQ#S5B5jL3w6WKdrm-2HRGWAenZ892STloZj9fkkgvvnLY
        - https://mega.nz/file/AGFQybDT#94VBOrv6bSKaCImIRM0f6FEQUcUQTvvXEmMdajYX-uM
        - https://mega.nz/file/sCUVDRqb#pe1bFwTIIYQvXecIzLVcq_lmRQp3uIXhSzwCIS4RN90
        - https://mega.nz/file/8O10TZJD#ISZTgxwxK6pfLFj76g8i2lttuRGH5icOY717a0CqF7s
        - https://mega.nz/file/kDsVzTrJ#Kxy9h4kP1VrHqSlvb3g54QXaUKZMXqQjHxNSjR5IvDA
        - https://mega.nz/file/4ClEnJwC#BV3Fn9hA3t0s7E2siDAkxNBvpTrnz1rYeBVIEqxclJM
        - https://mega.nz/file/Ra8jAQ7K#REZBhPMGYxrnFy-b9DtvDOhe5LbmlnJlNJadsUk6hQI
        - https://mega.nz/file/wP0jATQD#eyY_J_o-zi1foum4bFvXy5cAbtfet_DoXtzT-VTs21M
        - https://mega.nz/file/hWsmXb5Y#85XzgKofvVQ5DTdlKG-Nhq42VVRHd9PwXo2mr2LCLYM
        - https://mega.nz/file/tHUQSajR#oBGZLB2rWsK6my8lETSi_NXVno84hKJvxLJ4fcMKm0Y
        - https://mega.nz/file/sHUgGQoT#gLiNmYJ_bMTxCLSRPxWl5duBIUrC4Ld-YmXRfX4nXEg
        - https://mega.nz/file/ZKVh1DRB#x6qUOMcsXJBMk9dNf64G8oxBzYjmEWEeAxpmLF0IQ4g
        - https://mega.nz/file/dK02jTjR#dJVPyOMHJ-MXthbU9KV9zx-I19l4O_XZUnQFg0WfupY
        - https://mega.nz/file/5C0kkbzY#vSrV0iDCzIp2v-LJ7S6Oup9RhXMCaSCNXv0-Q4fXoEg
        - https://mega.nz/file/RWkBiSxB#Jj35NBqebhqh56dX0Rf03wM5vsIoGTHT-U2dejWrISo
        - https://mega.nz/file/UbUliDTK#mc9eDdpEpovV5bb_6DPoYeI9xcpncR-DLcyhwLKnOMU
        - https://mega.nz/file/BXcx1TTb#QhIGopO1fbtfSssTG9wVkyHXzbZzpnRSEsRU_zDZ-p4
        - https://mega.nz/file/oDEFDBra#gBUlKhzB8wpdk9cSsb6ef26jzxtfy-StZez2fdaZWp4
        - https://mega.nz/file/MbM0VKCY#2THSP7td7dOH3bSP0-F46YTubbPNPtm_wPct8JWAByA
        - https://mega.nz/file/ZaN2CY5D#YnX_jdWqvY32A_nRiY3_0QYZGmsMAhfTz2jvEBFOKRk
        - https://mega.nz/file/oD1B1AbC#jP2Cw0fN8qhPJpi62qVXlYzaIzbVcOOitSDXPppCxnI
    runs-on: ubuntu-latest
    steps:
    - uses: actions/cache@v4
      id: cache
      with:
        path: megatools-1.11.1.20230212-linux-x86_64
        key: megatools-1.11.1.20230212-linux-x86_64
    - name: Mega
      if: steps.cache.outputs.cache-hit != 'true'
      run: |
        curl -OL https://megatools.megous.com/builds/builds/megatools-1.11.1.20230212-linux-x86_64.tar.gz
        tar xvf *.gz
    - name: Leech
      run: |
        mkdir leech
        megatools*/megatools dl --path leech/ ${{ matrix.url }}
        cd leech
        find . -size +1960M -exec split -b 1G --numeric-suffixes=1 {} {}.0 \;
        find . -size +1960M -exec rm {} \;
    - name: Upload
      uses: svenstaro/upload-release-action@v2
      with:
        repo_token: ${{ secrets.GITHUB_TOKEN }}
        file: leech/*
        tag: latest
        overwrite: true
        file_glob: true
