name: leech

on:
  push:
    paths:
    - '.github/workflows/leech.yml'

jobs:
  build:
    strategy:
      fail-fast: false
      matrix:
        url:
        - https://mega.nz/file/3YVxWATT#6ESDOR_N_AiRWo4xHZqpRPML2frx-d2b6G2zEA0rwRo
        - https://mega.nz/file/vdEFjKLa#PSk-ZnkiaK9SLKpr3EtqLd-5UmlSIsqipNIBUlEKLH0
        - https://mega.nz/file/PYtC3LSR#ndXmXwfwfbXmvFMB3E_SRatsuPQKbw34sgF_CerkCg0
        - https://mega.nz/file/DU0klKSB#QXRLJVAw8Y2cITdCbpWLGkZR-rWu2TOpUtr-idzEXRI
        - https://mega.nz/file/CBsVEQpY#8-qjO_zeLHFjqo3NFnz30WBH45Qt3VfPf1msSeYE88w
        - https://mega.nz/file/3ZFh0LSJ#5tKxyio4PXHAzx8bSmaePM3oFOu4FnrWX9poLzt9vik
        - https://mega.nz/file/3M12iARY#1ssCXpOBP2Vyx6UyHxIVeseN6BCCW3QYGhBZpCvWXhU
        - https://mega.nz/file/vMtnzRzK#qac1hxKoWrEYcEiGgT8fBpmSXsC5VZ-OpuF1RfWt2MY
        - https://mega.nz/file/LU1XwZ6J#mKSYvq5RZFyfb9-bZ67rMwSL50WJYy7oEff-fZuX7CA
        - https://mega.nz/file/vFliRIxS#o6J76-ygUT1zENkJmSswkHOVZZ6gp4tp1eP204HSyNY
        - https://mega.nz/file/fU1GVTBL#BU_ucoHZEUrs4YOunLkwaq9iOA0DGSMFSFwXfmc3Qhs
        - https://mega.nz/file/uB0XiQjS#IA43wUe8Eh2SogqDasAMN_7rr6iAtrl6vimaGB5fWJs
        - https://mega.nz/file/OVVChKAJ#w4dyhoxGQP_ND7It86ndfRNPQJvggq5zoYxoWIgAyRk
        - https://mega.nz/file/rU0FzDjL#8kkuMe56JVQr--x-8-qYTzrK5cA9-Ub1YaZ8HU1UiRE
        - https://mega.nz/file/kiVjTB5Y#T2HWJW8Ccrv6O97_YwHftcPF7FwPO3PxyitmSzEJiLY
        - https://mega.nz/file/nR0yRAzb#Ex__YhVnObNBlicssjwo_VQ1EjYHtB_5iHIXLTRw270
        - https://mega.nz/file/KVsUVRwS#6YmAFKhcHFLo94wg7evqzyE-_y5bO4Gqb5LPTMlumE4
        - https://mega.nz/file/bIUAmTbS#YWMeD4hgwZ8mvQ4S4hEsSU_o5AMMXEsqdw0cXFUSJkE
        - https://mega.nz/file/eUU1SD5R#rNy-4tN_1PUz92bp6xQDANd0eUF1uFiZbi9jXCKxTLs
        - https://mega.nz/file/CUVyFLQT#qjHWAU_wet12Q1YC0D0eUoIZ4Nk6xYcCId3mUgV7N_c
        - https://mega.nz/file/KJFVXIqA#MoH82BnaafXyftRiDQsQkjsqrtXTvXS-jK6_OpC0K9Q
        - https://mega.nz/file/WVd1XZQQ#_BTw98ZdVCJd49vNYeWnab8QVkYOmUAl-TB4YwJ2Pgc
        - https://mega.nz/file/OQVQSCxR#5KOoVT-Onq4bRql3KY8ncZnkJvrxqsdtWiKRLPdKzgc
        - https://mega.nz/file/jJ1zQZyb#oIf4ifHssLsL555Wrxv7mwOFzVW0BJlv8Pr8v28ociw
        - https://mega.nz/file/yQUDXJSY#72CkOoDHDk41z4Bunob-O8bRRxJ5rAMi_WwBPisoRNQ
        - https://mega.nz/file/jM0EhaJI#wOl6GxN-hQwXtAHyWZFEkfuhOjAHJYoDjju0pQdNHF8
        - https://mega.nz/file/GINRVBRB#zUNdLgMTzqzXbbKI6f2FAtyUVAc0wbN0O0-Ht0f8MRM
    runs-on: ubuntu-latest
    steps:
    - uses: actions/cache@v4
      id: cache
      with:
        path: megatools-1.11.1.20230212-linux-x86_64
        key: megatools-1.11.1.20230212-linux-x86_64
    - name: Mega
      if: steps.cache.outputs.cache-hit != 'true'
      run: |
        curl -OL https://megatools.megous.com/builds/builds/megatools-1.11.1.20230212-linux-x86_64.tar.gz
        tar xvf *.gz
    - name: Leech
      run: |
        mkdir leech
        megatools*/megatools dl --path leech/ ${{ matrix.url }}
        cd leech
        find . -size +1960M -exec split -b 1G --numeric-suffixes=1 {} {}.0 \;
        find . -size +1960M -exec rm {} \;
    - name: Upload
      uses: svenstaro/upload-release-action@v2
      with:
        repo_token: ${{ secrets.GITHUB_TOKEN }}
        file: leech/*
        tag: latest
        overwrite: true
        file_glob: true
