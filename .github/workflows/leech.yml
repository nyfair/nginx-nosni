name: leech

on:
  push:
    paths:
    - '.github/workflows/leech.yml'

jobs:
  build:
    strategy:
      fail-fast: false
      matrix:
        url:
        - https://mega.nz/file/8bMiTaKb#2m5ONuAXeltPYLLygPDgg3vK9LqEF2E5ibz4Ya5-1Ao
        - https://mega.nz/file/lbsDWJzC#ZCjLm0OZK4XVwhATN85oMqzY7SW3vsWuGu_DAAFQP5Y
        - https://mega.nz/file/Jf9mQCpC#i66KjkQq9uRCHq1-i49rDQhrAH4UowlLYmVJyA6CfEk
        - https://mega.nz/file/Vf0HjahL#_kdtE98rjlXR65V4I5zGmapAobtffcaRI0wwQBU6p1g
        - https://mega.nz/file/dP9l0aoI#KfD4bxeY8UiusokWZqQaYcabXuG-FVs-cmnHeSNTJ4U
        - https://mega.nz/file/teFCSJZA#aUDdUTLq6D_fAL613hxGOgDOAG824LQUCC33zxJWsY0
        - https://mega.nz/file/gWlSmbQJ#jDg-Z5IlFybohanfNuAEfY2JTWYejwNBdHtAzANpDZY
        - https://mega.nz/file/IGEWiYRD#0HSP0eDlLYAnSuwnc1zfZl5m6eIHdIGuh5xtqkC1hO8
        - https://mega.nz/file/AD9jwL7C#KP0rFOUaPTVarWxs4J3Rq2w98Wsl-y_yIAUZV2lW7bg
        - https://mega.nz/file/RDU2XRDK#VjIJggSOPONLL55T4eitm9Y-AlQG8BcW30wIPYr2C_0
        - https://mega.nz/file/BGtEULxD#OCspqBQK9A4OYiGpq_NT3HbjsIiYpaXhog4y22YOj9k
        - https://mega.nz/file/QHUATDLZ#29_xy0QYKN4T45iBJFKO_kslvWCjajq3hh1mVqUCgtk
        - https://mega.nz/file/VTMylZZD#fgMoDc7Iqn2iNYZklyueD8gLEhcA1KSLPDpC3dR4Aw8
        - https://mega.nz/file/xeFB2BDR#VUeoRgllTtzJ-RBZgIgdwjPiqeBolyV8T5qwUvSJsfY
        - https://mega.nz/file/oGlQHQgK#5IKdD39KZEprVqePUS0BgwJwlf3J6X2IF228TkPhvoI
        - https://mega.nz/file/sHdUiJbK#gVrIrmwEE22Y62hXebySdYI6I6pDyeeadhysjMaPsTQ
        - https://mega.nz/file/UalTVD5I#ykw5wMS2uWRhaaiNAywFE4I2_rqmw1IuLp5KrzdHWfo
        - https://mega.nz/file/ML9R1ZoB#1MsuAVPN8UdXr7j3dV8oRsVwH3_oZOADLPVpP6mbXC4
        - https://mega.nz/file/cXUn0aRJ#LBOW3XPyxp-PB60ECXXGWi15YV6JxOnWZ2BD09eIrKQ
        - https://mega.nz/file/4S0wESBK#kOP51KejyiL-eaaMPtcr0fyT7AvOZVFnwFEvAYTtyVI
        - https://mega.nz/file/se01Aawa#Dc9ksbshIw8R8F8z7UNEh8J6-5Y2WxuOj7qtT2KWfOs
        - https://mega.nz/file/1C8lxRIR#2twN9Tbr0PEHryg12IaRbtdgo5BnPud2UF6zb8jD_8A
        - https://mega.nz/file/9ekByIAS#hFsMkKctbKgY6Mkr3zfUr6nl9qaXqVxD5dmRJH_f8bo
        - https://mega.nz/file/IHk1Db4C#2WVslcRMZR8JPLxLZQjlsaEzGLR-noZB8QsnoOfihDU
        - https://mega.nz/file/cD8QBCJQ#zC2znmq5_itQEcJSJrkvw2PEu_SzOjvV95Z0sMvEgNw
        - https://mega.nz/file/lPNQRAgB#MOxSG26bj4i-O7RFVL02pmI-ABoAiUwzAoeuuDfdGiE
        - https://mega.nz/file/lC8TjRyK#Fsul7_g0-MQL6-PxJuBaJjjlvZxHxyzYFGZ6XxbOtPo
        - https://mega.nz/file/wCUhSILa#_dDQmGexYVdj9GHdRMdf8lbSRvQqD-UyBB1rHLXV9hc
        - https://mega.nz/file/tDdGxRCa#9TENCJAG62w715iE7CCZTy87kbXd-FmAg65Dil9QrmM
        - https://mega.nz/file/4f0TSLKI#8SrfLBqOn9MYLnx6U5G-b8_AEny1uI7keB0mzxbCrHY
        - https://mega.nz/file/YOFjCLTR#fXfc7_lKhbX5rS4Q2z5vekXwDb4I9i9MScho7HuGQxI
        - https://mega.nz/file/9b9yRDwZ#Zkc_4S0n0mGFb27JyNWwDTf_PADsOSqctuIzy2rrkTU
    runs-on: ubuntu-latest
    steps:
    - uses: actions/cache@v4
      id: cache
      with:
        path: megatools-1.11.1.20230212-linux-x86_64
        key: megatools-1.11.1.20230212-linux-x86_64
    - name: Mega
      if: steps.cache.outputs.cache-hit != 'true'
      run: |
        curl -OL https://megatools.megous.com/builds/builds/megatools-1.11.1.20230212-linux-x86_64.tar.gz
        tar xvf *.gz
    - name: Leech
      run: |
        mkdir leech
        megatools*/megatools dl --path leech/ ${{ matrix.url }}
        cd leech
        find . -size +1960M -exec split -b 1G --numeric-suffixes=1 {} {}.0 \;
        find . -size +1960M -exec rm {} \;
    - name: Upload
      uses: svenstaro/upload-release-action@v2
      with:
        repo_token: ${{ secrets.GITHUB_TOKEN }}
        file: leech/*
        tag: latest
        overwrite: true
        file_glob: true
