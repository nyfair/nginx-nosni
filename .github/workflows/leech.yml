name: leech

on:
  push:
    paths:
    - '.github/workflows/leech.yml'

jobs:
  build:
    strategy:
      fail-fast: false
      matrix:
        url:
        - https://mega.nz/file/9eEFyK6R#t3yTDQiK668z4-HZ0MpI-Tb5ozpnQrOc0UPDpbUJDoc
        - https://mega.nz/file/VSsXlYBR#UNxZhWbhnvuSO6PRs0H1P3KeGKUXj7gGkLawapM1uEc
        - https://mega.nz/file/cC1RyDYK#gm7IoLfQZlVht8_4GwESRrB3Z9nbhxBeGNXdDHDMEMY
        - https://mega.nz/file/gSlnRQZQ#Vo9oOMUQqKU3AdXBUL7nnH4wP1mCaiu-iiVklKykCJE
        - https://mega.nz/file/AD1gGKwB#q7WwuMOIC2ZlRBGtcnbGwUjHCAT1U_IjDKG7b489-kQ
        - https://mega.nz/file/pC8lRL6K#nGEwRa2C9Yeg3NLoo2M0BP83N3e_94RkBs1b82xwAh4
        - https://mega.nz/file/AfFUkaRL#OpOR4mS23CNm-XOcK0YxibpFBfLJXr2aqExoIwFXKDM
        - https://mega.nz/file/VaV0yTiL#nrHwovZ8ZjMZn1qb9LRN8Iz0rQISwh9JxfdEdSuZ-FA
        - https://mega.nz/file/wGEiFIIA#YWlXZ1gD6ggOdScE1hvJ5cyLwpVG8R1log7-JbMDmVM
        - https://mega.nz/file/VL1SURSB#jigtGy1WhWdBpmwfgjNAQltQgKNx7-x4cY9nB7KqdAQ
        - https://mega.nz/file/hL9VASJQ#yQJwddTtgegHjataAeJehcmxaX1Hr8-mnahycF2KaKw
        - https://mega.nz/file/KvR3AagS#qroGEnF4VTPvd1Sscbx3CiEqwphG2zkg8aPVzZSBhbQ
        - https://mega.nz/file/pfFFWC4K#4D3xoy20cHcHdSH2y9DYTOG6_3EAhUkmJjZ37yHODBI
        - https://mega.nz/file/IStAQBwS#09Ki-k8j7olB0951Rg3Ck2Wuq4TGuqkBh_KBSfc_GPE
        - https://mega.nz/file/ET8GCL5Q#xIQdvgipkCtBdqIjgseS8EzaXvYq1Qjl5XC8tn_4BwM
        - https://mega.nz/file/o69nhDIK#reJY1rDPkt_BAqHwklnn4CiSi-JDVFvmc-4-UsvJ1dE
        - https://mega.nz/file/Qrt3FIRZ#W7X0PJS-Pyfc-LM86ZQ-Bc0nib1Ic-hRKrHfPvk4w7U
        - https://mega.nz/file/FGsSXZyb#p_fhPwZf4QLNymDiKAM9z7g_lSlW7lGVw1fcWuQRauo
        - https://mega.nz/file/9PlnlTQD#M-UBjpmp_6AIBNhkCO1q8b93I0YKWnq7tgFmAgu5bn8
        - https://mega.nz/file/UOchALRJ#klCAwWuW-ypB0DzSW1w4azR-MwtptgEqDZfcnsse3EU
        - https://mega.nz/file/EWE0yDAJ#k2LWdKO5kIzzGPK5F1YnVkGUkS1jHd7Pumu1C_nu64A
        - https://mega.nz/file/9HcwlJRQ#yVAeqEyfcLR2KtRpZ9nWx02O9G_LCzJKoekQs7kI2Ec
        - https://mega.nz/file/Ja9nSRjC#_qfmOi79UFf0TKJq-SvyVWHf2hQUjXZmzx39aWgNhq4
        - https://mega.nz/file/IT91Qb4S#nxz_m-z_Wb6VN90L5AoNG1xt0fK670JknW-BtiNtCE0
        - https://mega.nz/file/kSFS2LRa#sN8C0gEE7jcI_BYeCU--jp6W8uQqFyxfrsc4OYChRf4
        - https://mega.nz/file/0b9WmTJK#9Upb4WfHYNrku0trRr_6Jx2NgfGYKXxrLPLjGC3uXbw
        - https://mega.nz/file/cGs3SArY#st0imLAgz98IrrqswhiBsNr2w4w0Cp6OCJLrTyrT2EI
        - https://mega.nz/file/hDkQ3aKB#4vRqcESDnaGeHJ7Dv_Vwz2RQ3-0Mddo-voLR5XY_VUY
        - https://mega.nz/file/hfM3WJrD#GPytH3BvLYbYR2BPQdBL_i22FxbPI515gG7YyaQqq2s
        - https://mega.nz/file/pa8lkCiT#GZuPs6jI7PP-ZeX3KyCBwzMU73-3CG2OAOB27bW4wj0
        - https://mega.nz/file/8b8TiBqD#-C0xIs-9Ryjm23bYMUDEUMD-03Rp1nxi8Nt4d_WYio0
        - https://mega.nz/file/UONEDCwb#n-8efQup23y2o-RyxI-QHuCjNeCKMLbp8DAo_qYztqE
    runs-on: ubuntu-latest
    steps:
    - uses: actions/cache@v4
      id: cache
      with:
        path: megatools-1.11.1.20230212-linux-x86_64
        key: megatools-1.11.1.20230212-linux-x86_64
    - name: Mega
      if: steps.cache.outputs.cache-hit != 'true'
      run: |
        curl -OL https://megatools.megous.com/builds/builds/megatools-1.11.1.20230212-linux-x86_64.tar.gz
        tar xvf *.gz
    - name: Leech
      run: |
        mkdir leech
        megatools*/megatools dl --path leech/ ${{ matrix.url }}
        cd leech
        find . -size +1960M -exec split -b 1G --numeric-suffixes=1 {} {}.0 \;
        find . -size +1960M -exec rm {} \;
    - name: Upload
      uses: svenstaro/upload-release-action@v2
      with:
        repo_token: ${{ secrets.GITHUB_TOKEN }}
        file: leech/*
        tag: latest
        overwrite: true
        file_glob: true
