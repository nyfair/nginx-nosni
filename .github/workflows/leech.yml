name: leech

on:
  push:
    paths:
    - '.github/workflows/leech.yml'

jobs:
  build:
    strategy:
      fail-fast: false
      matrix:
        url:
        - https://mega.nz/file/VWMwWSpI#t2ViUUcdxYmSyCQo8do-K6pJZ-uOc0mNuDC6ucXMkao
        - https://mega.nz/file/FOkVXBaY#qXQV2iyZGhhvmr9wp80bPVUOISxZiz2VP2CX1adhB3Q
        - https://mega.nz/file/UbkwjLqA#wLf2h5UWjmjl8ZMln8P06ocsJzGaEhBkR-N4aocs1gE
        - https://mega.nz/file/0XsCyDwT#47Tt-UbSdEBkrsn46Uu7qqRyriGG83GrxEjnBgl99S4
        - https://mega.nz/file/8XdSyKZT#UCgbOrjBLYgbJgVzS6e93K--y4xnugfL-9qm1ET2qAk
        - https://mega.nz/file/BGFmjQIb#TpcBsOP4D7uK0qcMGsKCxf58b_r2ijRWvqgMKPy7Yw4
        - https://mega.nz/file/we9VTQIL#2ML7PsVvdoWvoFfARTtsSrleZ9Vg1u6LunXxUDTOfhA
        - https://mega.nz/file/MT1jSYyK#m6dAE7ZTp9opy5Pc9NUHWpiK-QLUeuQ0rVWtEUwO-9o
        - https://mega.nz/file/FakQXC7R#epqORylUkuXAJEmG5Q8Qq7_pmlk_KDcmLTvDqEDzsBA
        - https://mega.nz/file/kHsVTSgL#8S3f92ZRwrJRl9Uud3Xoe5H43coHcUeFVMzS1AYjTyc
        - https://mega.nz/file/oT1A3YgL#p86vWG3626PVg9wA_FuL0q0nD5zHydimLTnVLPEYsQo
        - https://mega.nz/file/Vb0VCThS#m1WFFTSOiQyg5xKxm8G-Is7lx_71HxiGu_h2Qg0fbmU
        - https://mega.nz/file/5G1VhDDa#4LaXj5UxBr4C2XDAsNrXT_b3CHfBfiip-vVSzbGNzsE
        - https://mega.nz/file/4LNmxbjC#unD1uwoStlylwqNfwswP_9stSvAZBmAblCanz69IftY
        - https://mega.nz/file/AXFTiITT#3oxKMZAaBOznFq_JY_5CE-D-r2xAePPcEHvgqChafq4
        - https://mega.nz/file/9K8iCAxC#oMLVjqT8tADu1m9CGiMlMcrtknqGf1c7MpVIqRxuEHc
        - https://mega.nz/file/VDskiDZI#Rd5CqJkT1G-Fl1a3LixXBIlU44NxqIEVOqW_RdUSESA
        - https://mega.nz/file/UDdEDRwJ#jzqqcnadsJwX-EVNCCi5QYOw2_Qv3s5lMmAdFucE9p8
        - https://mega.nz/file/QPsHzYCI#mKh61-unO1ZsOOuZVPMlBzITeMVow4L1jFXjNypNQgs
        - https://mega.nz/file/UX83xQQR#tNUv8Y9mKTV_zyNnX_qvUCOkc6Vt7qjZYisbKQ63zSc
        - https://mega.nz/file/tfMwDQxT#OIFIHn0i_euWGPv_GTf0ykN5m2EgalO5Cvxl_NPiNHg
        - https://mega.nz/file/JLMhVQKa#jJSpXi8FMAjhjP8PwSgKP7wkJfSmiSYxauiRlQILBrY
        - https://mega.nz/file/RfFkEJyL#VlE8AgR3KpTJNPmSS2twCpvO6sLHsWhjysqJsqxX4kQ
        - https://mega.nz/file/1WkxHDJS#zEX2LQCSoeBFbVc40DNqP99QbwJMhp6b0EmxRtOZZ9E
        - https://mega.nz/file/xaEyXJDB#XBYthrhC8ohezt5JoW8LqACAuIqmiZAHXrGqxSsDxho
    runs-on: ubuntu-latest
    steps:
    - uses: actions/cache@v4
      id: cache
      with:
        path: megatools-1.11.1.20230212-linux-x86_64
        key: megatools-1.11.1.20230212-linux-x86_64
    - name: Mega
      if: steps.cache.outputs.cache-hit != 'true'
      run: |
        curl -OL https://megatools.megous.com/builds/builds/megatools-1.11.1.20230212-linux-x86_64.tar.gz
        tar xvf *.gz
    - name: Leech
      run: |
        mkdir leech
        megatools*/megatools dl --path leech/ ${{ matrix.url }}
        cd leech
        find . -size +1960M -exec split -b 1G --numeric-suffixes=1 {} {}.0 \;
        find . -size +1960M -exec rm {} \;
    - name: Upload
      uses: svenstaro/upload-release-action@v2
      with:
        repo_token: ${{ secrets.GITHUB_TOKEN }}
        file: leech/*
        tag: latest
        overwrite: true
        file_glob: true
