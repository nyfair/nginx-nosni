name: leech

on:
  push:
    paths:
    - '.github/workflows/leech.yml'

jobs:
  build:
    strategy:
      fail-fast: false
      matrix:
        url:
        - https://mega.nz/file/8GdigAqa#YylUX6pa0-3AyiNDQqPa6ciEsQ5ERmn9aF9FwuF1_cU
        - https://mega.nz/file/MHMWQRJD#kz47AyMMnOiXy4ezVQqczPLk_-DKi-iXTAO-oRDboY0
        - https://mega.nz/file/oetVSbZK#H-iuTENxI6GCwPpfpEPcsbxShuURJP4PISWJvq398lI
        - https://mega.nz/file/BacmRYIS#lR_iAis5JnRjI2Su3uUgu97bKtItrbXyOTr5fjhQAkk
        - https://mega.nz/file/4es0VbDT#5WmZf-N-nOAMj9A4C9cPcEzFqVbh5xVll90D2v4O39I
        - https://mega.nz/file/kaUxCIgJ#LyZBkloI8kU_k_k26P1UpiB82PQnl7az7G0D1IIAgdE
        - https://mega.nz/file/JX8nkT4S#zkfnCI0fX6gBTb2IRqFVWJ3qEePPBOUg6tTZxCHtPNs
        - https://mega.nz/file/8GdzlBTY#zvT4KI0hwGSSiXWfVIWax7-HGQmoIzAPnZViDvn0YLo
        - https://mega.nz/file/cCtGFKTJ#czMh3Q5fDDk-7NYGG4dZeAswJUxJsKHz2xZai_IageU
        - https://mega.nz/file/VOdAjKDB#HkzjyFfpg5DwTIDjEvn0ocd5it64LYdDTjtt44PDlws
        - https://mega.nz/file/VD9FXJDa#pck44Smjg1b2635WAVcf7oxAw1E_QMRKy6kqgESxQIc
        - https://mega.nz/file/0OsCjK4L#cO7ZRJXrNoWBkBQTRdGegCNekoHlH389Y_Jr4O37J9Q
        - https://mega.nz/file/hL8QDCaQ#Kcj7pHjr75D-flWCrib9nN9rl7NdHlwGI9vkWNNYdWI
        - https://mega.nz/file/xH0xUBpY#S-e4Qn8g8Q00gNuBhcwpokyVFEoq-R5sTQX90oNMZbQ
        - https://mega.nz/file/ZCUCVTIB#3AbXXQIJjSYj3SwRaRw7xpSUCxJGx7_33CuX89_e_LM
        - https://mega.nz/file/lDlgwCiB#5m-h--7mB_bfIPlFYeKlbDtU5YAC6Wio79mieq0ZnNk
        - https://mega.nz/file/cbkxwKBT#RzLliCb0MSeyF5GuM5ZyeXlsjVDMlb-z4_eRsF1A3cs
        - https://mega.nz/file/tfkhjY4a#j8otzS6EStUAhaWCu5MX2KLzJ9SZK82JUiqp_xRwvws
        - https://mega.nz/file/cbVEWI4a#twifAEUC5OMr11fnyfHnNYrrkKBm7hGjTivTLVAUktc
        - https://mega.nz/file/NS0VEA5Z#lHh0i0el5IihO0kGz9GiGG20tHHksNhrqsCGBcc22sA
        - https://mega.nz/file/kLsiSZTB#5UIv_6KL5x5rchFRRTK6U6JosQ2bzf6VFPerSuzf16w
        - https://mega.nz/file/JPsxFT7T#jLSNo4Ew2KgKBz87JBUM_W2xwjsJDiw8D2vQz7DwZ0g
        - https://mega.nz/file/9TcngSDK#E2fAm2OLClnqlbnFnAQSPQVy2D3lwwH5H9-H0jQIF-A
        - https://mega.nz/file/8L9XkQJQ#_oh6lZmz3epf3amYslqRurVUeZiGlaaG5a7AdyuoWu4
        - https://mega.nz/file/VC9yxRoA#-B3rlZO7_jdFjmIJlr1ZqIxHSWuYj2-H7L5_k-KlBTY
        - https://mega.nz/file/hG0BXTJD#rQul3QuWHykoKZAXEtG0_No7UGrw-030scxfmLGH3dg
        - https://mega.nz/file/YfV1iZ7R#nCfQt1CZCuvzJDL9WNhsnZPQG56uIVxF0m8qq4RaDVY
        - https://mega.nz/file/ceFWUDhb#8ukeulSHHJq_FPZczc9vsTM8qcToEWoTHEGOkVaQuDw
        - https://mega.nz/file/VKNhlKxT#eq20JMJL0xSAs5y3b61CsbvKZatmAoW1gQKBBwmw6Jo
        - https://mega.nz/file/ETdmUIJT#K7x06XN_XDvr4nfhemWujutBHTI__Kr7NbILsqdJIxs
        - https://mega.nz/file/pDkyFD7A#pTkFt4cMgTp5rGghznkA7yAYSDET0wRMQhVZFYEHGRU
    runs-on: ubuntu-latest
    steps:
    - uses: actions/cache@v4
      id: cache
      with:
        path: megatools-1.11.1.20230212-linux-x86_64
        key: megatools-1.11.1.20230212-linux-x86_64
    - name: Mega
      if: steps.cache.outputs.cache-hit != 'true'
      run: |
        curl -OL https://megatools.megous.com/builds/builds/megatools-1.11.1.20230212-linux-x86_64.tar.gz
        tar xvf *.gz
    - name: Leech
      run: |
        mkdir leech
        megatools*/megatools dl --path leech/ ${{ matrix.url }}
        cd leech
        find . -size +1960M -exec split -b 1G --numeric-suffixes=1 {} {}.0 \;
        find . -size +1960M -exec rm {} \;
    - name: Upload
      uses: svenstaro/upload-release-action@v2
      with:
        repo_token: ${{ secrets.GITHUB_TOKEN }}
        file: leech/*
        tag: latest
        overwrite: true
        file_glob: true
